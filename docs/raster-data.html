<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Raster data | R cookbook for the casual dabbler (2nd edition)</title>
  <meta name="description" content="A practical user guide for R in analysis and visualisation." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Raster data | R cookbook for the casual dabbler (2nd edition)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A practical user guide for R in analysis and visualisation." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Raster data | R cookbook for the casual dabbler (2nd edition)" />
  
  <meta name="twitter:description" content="A practical user guide for R in analysis and visualisation." />
  

<meta name="author" content="Charles Coverdale" />


<meta name="date" content="2025-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="drivetime-analysis.html"/>
<link rel="next" href="abs-economic-indicators.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Cookbook for the Casual Dabbler</a></li> 

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#additional-resources"><i class="fa fa-check"></i><b>1.2</b> Additional resources</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#limitations"><i class="fa fa-check"></i><b>1.3</b> Limitations</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.4</b> About the author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html"><i class="fa fa-check"></i><b>2</b> Making maps beautiful</a>
<ul>
<li class="chapter" data-level="2.1" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#why-use-a-map"><i class="fa fa-check"></i><b>2.1</b> Why use a map</a></li>
<li class="chapter" data-level="2.2" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-okay-to-good"><i class="fa fa-check"></i><b>2.3</b> From okay to good</a></li>
<li class="chapter" data-level="2.4" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-good-to-great"><i class="fa fa-check"></i><b>2.4</b> From good to great</a></li>
<li class="chapter" data-level="2.5" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-great-to-fantastic"><i class="fa fa-check"></i><b>2.5</b> From great to fantastic</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>3</b> Charts</a>
<ul>
<li class="chapter" data-level="3.1" data-path="charts.html"><a href="charts.html#packages-matter"><i class="fa fa-check"></i><b>3.1</b> Packages matter</a></li>
<li class="chapter" data-level="3.2" data-path="charts.html"><a href="charts.html#make-the-data-tidy"><i class="fa fa-check"></i><b>3.2</b> Make the data tidy</a></li>
<li class="chapter" data-level="3.3" data-path="charts.html"><a href="charts.html#line-plot"><i class="fa fa-check"></i><b>3.3</b> Line plot</a></li>
<li class="chapter" data-level="3.4" data-path="charts.html"><a href="charts.html#scatter-and-trend-plot"><i class="fa fa-check"></i><b>3.4</b> Scatter and trend plot</a></li>
<li class="chapter" data-level="3.5" data-path="charts.html"><a href="charts.html#shading-areas-on-plots"><i class="fa fa-check"></i><b>3.5</b> Shading areas on plots</a></li>
<li class="chapter" data-level="3.6" data-path="charts.html"><a href="charts.html#bar-chart"><i class="fa fa-check"></i><b>3.6</b> Bar chart</a></li>
<li class="chapter" data-level="3.7" data-path="charts.html"><a href="charts.html#stacked-bar-chart"><i class="fa fa-check"></i><b>3.7</b> Stacked bar chart</a></li>
<li class="chapter" data-level="3.8" data-path="charts.html"><a href="charts.html#histogram"><i class="fa fa-check"></i><b>3.8</b> Histogram</a></li>
<li class="chapter" data-level="3.9" data-path="charts.html"><a href="charts.html#ridge-chart"><i class="fa fa-check"></i><b>3.9</b> Ridge chart</a></li>
<li class="chapter" data-level="3.10" data-path="charts.html"><a href="charts.html#bbc-style-bar-charts-categorical"><i class="fa fa-check"></i><b>3.10</b> BBC style: Bar charts (categorical)</a></li>
<li class="chapter" data-level="3.11" data-path="charts.html"><a href="charts.html#bbc-style-dumbbell-charts"><i class="fa fa-check"></i><b>3.11</b> BBC style: Dumbbell charts</a></li>
<li class="chapter" data-level="3.12" data-path="charts.html"><a href="charts.html#facet-wraps"><i class="fa fa-check"></i><b>3.12</b> Facet wraps</a></li>
<li class="chapter" data-level="3.13" data-path="charts.html"><a href="charts.html#pie-chart"><i class="fa fa-check"></i><b>3.13</b> Pie chart</a></li>
<li class="chapter" data-level="3.14" data-path="charts.html"><a href="charts.html#patchwork"><i class="fa fa-check"></i><b>3.14</b> Patchwork</a></li>
<li class="chapter" data-level="3.15" data-path="charts.html"><a href="charts.html#saving-to-powerpoint"><i class="fa fa-check"></i><b>3.15</b> Saving to powerpoint</a></li>
<li class="chapter" data-level="3.16" data-path="charts.html"><a href="charts.html#automating-chart-creation"><i class="fa fa-check"></i><b>3.16</b> Automating chart creation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-modelling.html"><a href="basic-modelling.html"><i class="fa fa-check"></i><b>4</b> Basic modelling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-modelling.html"><a href="basic-modelling.html#source-format-and-plot-data"><i class="fa fa-check"></i><b>4.1</b> Source, format, and plot data</a></li>
<li class="chapter" data-level="4.2" data-path="basic-modelling.html"><a href="basic-modelling.html#build-a-linear-model"><i class="fa fa-check"></i><b>4.2</b> Build a linear model</a></li>
<li class="chapter" data-level="4.3" data-path="basic-modelling.html"><a href="basic-modelling.html#analyse-the-model-fit"><i class="fa fa-check"></i><b>4.3</b> Analyse the model fit</a></li>
<li class="chapter" data-level="4.4" data-path="basic-modelling.html"><a href="basic-modelling.html#compare-the-predicted-values-with-the-actual-values"><i class="fa fa-check"></i><b>4.4</b> Compare the predicted values with the actual values</a></li>
<li class="chapter" data-level="4.5" data-path="basic-modelling.html"><a href="basic-modelling.html#analyse-the-residuals"><i class="fa fa-check"></i><b>4.5</b> Analyse the residuals</a></li>
<li class="chapter" data-level="4.6" data-path="basic-modelling.html"><a href="basic-modelling.html#linear-regression-with-more-than-one-variable"><i class="fa fa-check"></i><b>4.6</b> Linear regression with more than one variable</a></li>
<li class="chapter" data-level="4.7" data-path="basic-modelling.html"><a href="basic-modelling.html#fitting-a-polynomial-regression"><i class="fa fa-check"></i><b>4.7</b> Fitting a polynomial regression</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-quick-refresher"><i class="fa fa-check"></i><b>5.1</b> A quick refresher</a></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#t-testing-our-first-hypothesis"><i class="fa fa-check"></i><b>5.2</b> T-testing our first hypothesis</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#understanding-tailed-tests"><i class="fa fa-check"></i><b>5.3</b> Understanding tailed tests</a></li>
<li class="chapter" data-level="5.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#correlation"><i class="fa fa-check"></i><b>5.4</b> Correlation</a></li>
<li class="chapter" data-level="5.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-the-mean"><i class="fa fa-check"></i><b>5.5</b> Confidence intervals for the mean</a></li>
<li class="chapter" data-level="5.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-a-model"><i class="fa fa-check"></i><b>5.6</b> Confidence intervals for a model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>6</b> Forecasting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="forecasting.html"><a href="forecasting.html#arima-models"><i class="fa fa-check"></i><b>6.1</b> ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>7</b> Web scraping</a>
<ul>
<li class="chapter" data-level="7.1" data-path="web-scraping.html"><a href="web-scraping.html#why-it-matters"><i class="fa fa-check"></i><b>7.1</b> Why it matters</a></li>
<li class="chapter" data-level="7.2" data-path="web-scraping.html"><a href="web-scraping.html#anatomy-of-a-webpage"><i class="fa fa-check"></i><b>7.2</b> Anatomy of a webpage</a></li>
<li class="chapter" data-level="7.3" data-path="web-scraping.html"><a href="web-scraping.html#scraping-a-table"><i class="fa fa-check"></i><b>7.3</b> Scraping a table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>8</b> Text mining</a>
<ul>
<li class="chapter" data-level="8.1" data-path="text-mining.html"><a href="text-mining.html#frequency-analysis"><i class="fa fa-check"></i><b>8.1</b> Frequency analysis</a></li>
<li class="chapter" data-level="8.2" data-path="text-mining.html"><a href="text-mining.html#sentiment-analysis"><i class="fa fa-check"></i><b>8.2</b> Sentiment analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>9</b> Geocoding</a></li>
<li class="chapter" data-level="10" data-path="drivetime-analysis.html"><a href="drivetime-analysis.html"><i class="fa fa-check"></i><b>10</b> Drivetime analysis</a></li>
<li class="chapter" data-level="11" data-path="raster-data.html"><a href="raster-data.html"><i class="fa fa-check"></i><b>11</b> Raster data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="raster-data.html"><a href="raster-data.html#import-raster"><i class="fa fa-check"></i><b>11.1</b> Import raster</a></li>
<li class="chapter" data-level="11.2" data-path="raster-data.html"><a href="raster-data.html#choosing-geographies"><i class="fa fa-check"></i><b>11.2</b> Choosing geographies</a></li>
<li class="chapter" data-level="11.3" data-path="raster-data.html"><a href="raster-data.html#analysis-with-raster-data"><i class="fa fa-check"></i><b>11.3</b> Analysis with raster data</a></li>
<li class="chapter" data-level="11.4" data-path="raster-data.html"><a href="raster-data.html#making-an-interactive-map"><i class="fa fa-check"></i><b>11.4</b> Making an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="abs-economic-indicators.html"><a href="abs-economic-indicators.html"><i class="fa fa-check"></i><b>12</b> ABS economic indicators</a></li>
<li class="chapter" data-level="13" data-path="australian-election-data.html"><a href="australian-election-data.html"><i class="fa fa-check"></i><b>13</b> Australian election data</a></li>
<li class="chapter" data-level="14" data-path="bayesian-for-the-common-man.html"><a href="bayesian-for-the-common-man.html"><i class="fa fa-check"></i><b>14</b> Bayesian for the common man</a></li>
<li class="divider"></li>
<li><a href="https://www.linkedin.com/in/charlescoverdale/" target="blank">Connect with me on linkedin</a></li>
<li><a href="https://github.com/charlescoverdale/casualdabbler2e" target="blank">Get the code on github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R cookbook for the casual dabbler (2nd edition)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="raster-data" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Raster data<a href="raster-data.html#raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Raster data (sometimes referred to as gridded data) is a type of spatial data that is stored in a grid rather than a polygon. Imagine a chessboard of individuals squares covering the Australian landmass compared to 8 different shapes covering each state and territory.</p>
<p>The nice thing about gridded data is that all the cells in the grid are the same size - making calculations much easier. The tricky part is those squares are overlayed on a (very roughly) spherical earth. We’ll have to think about mapping projections along the way.</p>
<p>Let’s get started. First up we need to load some spatial and data crunching packages.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="raster-data.html#cb99-1" tabindex="-1"></a><span class="co"># Core tidyverse packages (includes ggplot2, dplyr, tidyr, broom, etc.)</span></span>
<span id="cb99-2"><a href="raster-data.html#cb99-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb99-3"><a href="raster-data.html#cb99-3" tabindex="-1"></a></span>
<span id="cb99-4"><a href="raster-data.html#cb99-4" tabindex="-1"></a><span class="co"># Spatial data handling</span></span>
<span id="cb99-5"><a href="raster-data.html#cb99-5" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Modern replacement for sp + rgdal</span></span>
<span id="cb99-6"><a href="raster-data.html#cb99-6" tabindex="-1"></a><span class="fu">library</span>(raster)     <span class="co"># Working with raster data</span></span>
<span id="cb99-7"><a href="raster-data.html#cb99-7" tabindex="-1"></a><span class="fu">library</span>(ncdf4)      <span class="co"># NetCDF file handling</span></span>
<span id="cb99-8"><a href="raster-data.html#cb99-8" tabindex="-1"></a><span class="fu">library</span>(leaflet)    <span class="co"># Interactive maps</span></span>
<span id="cb99-9"><a href="raster-data.html#cb99-9" tabindex="-1"></a></span>
<span id="cb99-10"><a href="raster-data.html#cb99-10" tabindex="-1"></a><span class="co"># Mapping &amp; Visualization</span></span>
<span id="cb99-11"><a href="raster-data.html#cb99-11" tabindex="-1"></a><span class="fu">library</span>(ggspatial)  <span class="co"># Adds scale bars, north arrows, etc.</span></span>
<span id="cb99-12"><a href="raster-data.html#cb99-12" tabindex="-1"></a><span class="co">#library(tmap)       # Thematic mapping</span></span>
<span id="cb99-13"><a href="raster-data.html#cb99-13" tabindex="-1"></a><span class="fu">library</span>(ggmap)      <span class="co"># Google Maps integration</span></span>
<span id="cb99-14"><a href="raster-data.html#cb99-14" tabindex="-1"></a><span class="fu">library</span>(rasterVis)  <span class="co"># Raster visualization</span></span>
<span id="cb99-15"><a href="raster-data.html#cb99-15" tabindex="-1"></a><span class="fu">library</span>(viridis)    <span class="co"># Color scales for ggplot2 and rasterVis</span></span>
<span id="cb99-16"><a href="raster-data.html#cb99-16" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co"># Color palettes</span></span>
<span id="cb99-17"><a href="raster-data.html#cb99-17" tabindex="-1"></a></span>
<span id="cb99-18"><a href="raster-data.html#cb99-18" tabindex="-1"></a><span class="co"># Other Utilities</span></span>
<span id="cb99-19"><a href="raster-data.html#cb99-19" tabindex="-1"></a><span class="fu">library</span>(absmapsdata) <span class="co"># Australian Bureau of Statistics map data</span></span></code></pre></div>
<div id="import-raster" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Import raster<a href="raster-data.html#import-raster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we want to import annual rainfall data from github (original source available from the Bureau of Meterology)</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="raster-data.html#cb100-1" tabindex="-1"></a>rainfall <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;https://raw.github.com/charlescoverdale/ERF/master/rainan.txt&quot;</span>)</span>
<span id="cb100-2"><a href="raster-data.html#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="raster-data.html#cb100-3" tabindex="-1"></a><span class="fu">plot</span>(rainfall)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Straight away we see this is for the whole of Australia (and then some). We’re only interested in what’s going on in QLD… so let’s crop the data down to scale. For this we’ll need to import a shapefile for QLD.</p>
<p>The easiest way to do this is using the absmapsdata package - importing a shapefile of Australia then filtering for only Queensland.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="raster-data.html#cb101-1" tabindex="-1"></a><span class="co"># Import a polygon for the state of Queensland</span></span>
<span id="cb101-2"><a href="raster-data.html#cb101-2" tabindex="-1"></a>QLD_shape <span class="ot">&lt;-</span> absmapsdata<span class="sc">::</span>state2016 <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="raster-data.html#cb101-3" tabindex="-1"></a>             <span class="fu">filter</span>(state_name_2016<span class="sc">==</span><span class="st">&quot;Queensland&quot;</span>)</span></code></pre></div>
</div>
<div id="choosing-geographies" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Choosing geographies<a href="raster-data.html#choosing-geographies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have raster data for the entirety of Australia (and then some as it’s pulled from one of the BOMs satellites). This is a bit messy to work with - so let’s crop the rainfall data from the entire Australian continent to just Queensland.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="raster-data.html#cb102-1" tabindex="-1"></a><span class="co">#Crop data</span></span>
<span id="cb102-2"><a href="raster-data.html#cb102-2" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">crop</span>(rainfall,<span class="fu">extent</span>(QLD_shape))</span>
<span id="cb102-3"><a href="raster-data.html#cb102-3" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="fu">mask</span>(r2,QLD_shape)</span>
<span id="cb102-4"><a href="raster-data.html#cb102-4" tabindex="-1"></a><span class="fu">plot</span>(r3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>]Next up, let’s transform the cropped raster into a data frame that we can use in the ggplot package.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="raster-data.html#cb103-1" tabindex="-1"></a>r3_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r3,<span class="at">xy=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-2"><a href="raster-data.html#cb103-2" tabindex="-1"></a></span>
<span id="cb103-3"><a href="raster-data.html#cb103-3" tabindex="-1"></a>r3_df <span class="ot">&lt;-</span> r3_df <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="raster-data.html#cb103-4" tabindex="-1"></a>         <span class="fu">filter</span>(rainan<span class="sc">!=</span><span class="st">&quot;NA&quot;</span>)</span>
<span id="cb103-5"><a href="raster-data.html#cb103-5" tabindex="-1"></a></span>
<span id="cb103-6"><a href="raster-data.html#cb103-6" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span>  </span>
<span id="cb103-7"><a href="raster-data.html#cb103-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>r3_df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>rainan)) <span class="sc">+</span> </span>
<span id="cb103-8"><a href="raster-data.html#cb103-8" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span></span>
<span id="cb103-9"><a href="raster-data.html#cb103-9" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb103-10"><a href="raster-data.html#cb103-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-11"><a href="raster-data.html#cb103-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width=</span><span class="fu">unit</span>(<span class="fl">1.2</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb103-12"><a href="raster-data.html#cb103-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Rainfall in QLD&quot;</span>,</span>
<span id="cb103-13"><a href="raster-data.html#cb103-13" tabindex="-1"></a>               <span class="at">subtitle =</span> <span class="st">&quot;Analysis from the Bureau of Meterology&quot;</span>,</span>
<span id="cb103-14"><a href="raster-data.html#cb103-14" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">&quot;Data: BOM 2021&quot;</span>,</span>
<span id="cb103-15"><a href="raster-data.html#cb103-15" tabindex="-1"></a>               <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb103-16"><a href="raster-data.html#cb103-16" tabindex="-1"></a>               <span class="at">y=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb103-17"><a href="raster-data.html#cb103-17" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;(mm)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb103-18"><a href="raster-data.html#cb103-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb103-19"><a href="raster-data.html#cb103-19" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb103-20"><a href="raster-data.html#cb103-20" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb103-21"><a href="raster-data.html#cb103-21" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb103-22"><a href="raster-data.html#cb103-22" tabindex="-1"></a>            <span class="co">#theme(legend.position = &quot;bottom&quot;)+</span></span>
<span id="cb103-23"><a href="raster-data.html#cb103-23" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb103-24"><a href="raster-data.html#cb103-24" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb103-25"><a href="raster-data.html#cb103-25" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p><br />
Excellent, we’ve got a working map of rainfall in Queensland using the ggplot package. We’ll tidy up the map also and add a title and some better colours.</p>
</div>
<div id="analysis-with-raster-data" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Analysis with raster data<a href="raster-data.html#analysis-with-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our first piece of data analysis, we’re going to look at areas with less than 600mm of annual rainfall. How many of our data points will have less than 600mm of rain? Let’s take a look at the data distribution and find out.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="raster-data.html#cb104-1" tabindex="-1"></a><span class="fu">ggplot</span>(r3_df) <span class="sc">+</span></span>
<span id="cb104-2"><a href="raster-data.html#cb104-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(rainan),<span class="at">binwidth=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb104-3"><a href="raster-data.html#cb104-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Distribution of annual rainfall in QLD&quot;</span>,</span>
<span id="cb104-4"><a href="raster-data.html#cb104-4" tabindex="-1"></a>               <span class="at">subtitle =</span> <span class="st">&quot;Data using a 5x5km grid&quot;</span>,</span>
<span id="cb104-5"><a href="raster-data.html#cb104-5" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meterology 2021&quot;</span>,</span>
<span id="cb104-6"><a href="raster-data.html#cb104-6" tabindex="-1"></a>               <span class="at">x=</span><span class="st">&quot;Rainfall (mm)&quot;</span>,</span>
<span id="cb104-7"><a href="raster-data.html#cb104-7" tabindex="-1"></a>               <span class="at">y=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb104-8"><a href="raster-data.html#cb104-8" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;(mm)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb104-9"><a href="raster-data.html#cb104-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb104-10"><a href="raster-data.html#cb104-10" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb104-11"><a href="raster-data.html#cb104-11" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb104-12"><a href="raster-data.html#cb104-12" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb104-13"><a href="raster-data.html#cb104-13" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb104-14"><a href="raster-data.html#cb104-14" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>Interesting. The data is heavily right tailed skewed (the mean will be much higher than the median)… and most of the data looks to be between 0-1000mm (this makes sense).</p>
<p>Let’s create a ‘flag’ column of 0’s and 1’s that shows when a data point is less than 600mm.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="raster-data.html#cb105-1" tabindex="-1"></a><span class="co"># Define flag column and colors</span></span>
<span id="cb105-2"><a href="raster-data.html#cb105-2" tabindex="-1"></a>r3_df <span class="ot">&lt;-</span> r3_df <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="raster-data.html#cb105-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">flag_600mm =</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(rainan <span class="sc">&lt;=</span> <span class="dv">600</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb105-4"><a href="raster-data.html#cb105-4" tabindex="-1"></a></span>
<span id="cb105-5"><a href="raster-data.html#cb105-5" tabindex="-1"></a>flag_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;#2FB300&quot;</span>)</span>
<span id="cb105-6"><a href="raster-data.html#cb105-6" tabindex="-1"></a></span>
<span id="cb105-7"><a href="raster-data.html#cb105-7" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb105-8"><a href="raster-data.html#cb105-8" tabindex="-1"></a><span class="fu">ggplot</span>(r3_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> flag_600mm)) <span class="sc">+</span>  </span>
<span id="cb105-9"><a href="raster-data.html#cb105-9" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb105-10"><a href="raster-data.html#cb105-10" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> flag_colours) <span class="sc">+</span></span>
<span id="cb105-11"><a href="raster-data.html#cb105-11" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb105-12"><a href="raster-data.html#cb105-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb105-13"><a href="raster-data.html#cb105-13" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb105-14"><a href="raster-data.html#cb105-14" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Areas with Less than 600mm of Annual Rainfall in QLD&quot;</span>,</span>
<span id="cb105-15"><a href="raster-data.html#cb105-15" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Identifying Suitable Land Parcels for ERF Plantings&quot;</span>,</span>
<span id="cb105-16"><a href="raster-data.html#cb105-16" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meteorology 2021&quot;</span>,</span>
<span id="cb105-17"><a href="raster-data.html#cb105-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb105-18"><a href="raster-data.html#cb105-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb105-19"><a href="raster-data.html#cb105-19" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;(mm)&quot;</span></span>
<span id="cb105-20"><a href="raster-data.html#cb105-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-21"><a href="raster-data.html#cb105-21" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb105-22"><a href="raster-data.html#cb105-22" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-23"><a href="raster-data.html#cb105-23" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-24"><a href="raster-data.html#cb105-24" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-25"><a href="raster-data.html#cb105-25" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb105-26"><a href="raster-data.html#cb105-26" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb105-27"><a href="raster-data.html#cb105-27" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb105-28"><a href="raster-data.html#cb105-28" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb105-29"><a href="raster-data.html#cb105-29" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
</div>
<div id="making-an-interactive-map" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Making an interactive map<a href="raster-data.html#making-an-interactive-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The static map above is good… but an interactive visual (ideally with place names below) is better. The <code>leaflet</code> package is exceptional here.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="raster-data.html#cb106-1" tabindex="-1"></a><span class="co"># This code creates an interactive leaflet map. It is commented out to allow the html version of RCCD2e to render online.</span></span>
<span id="cb106-2"><a href="raster-data.html#cb106-2" tabindex="-1"></a></span>
<span id="cb106-3"><a href="raster-data.html#cb106-3" tabindex="-1"></a><span class="co"># leaflet() %&gt;%</span></span>
<span id="cb106-4"><a href="raster-data.html#cb106-4" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb106-5"><a href="raster-data.html#cb106-5" tabindex="-1"></a><span class="co">#   addRasterImage(r5, opacity = 0.5) %&gt;%</span></span>
<span id="cb106-6"><a href="raster-data.html#cb106-6" tabindex="-1"></a><span class="co">#   addLegend(pal = colorNumeric(&quot;viridis&quot;, values(r5)), values = values(r5))</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="drivetime-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="abs-economic-indicators.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/charlescoverdale/casualdabbler2e/edit/master/11-raster-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
