<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Basic modelling | R cookbook for the casual dabbler (2nd edition)</title>
  <meta name="description" content="A practical user guide for R in analysis and visualisation." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Basic modelling | R cookbook for the casual dabbler (2nd edition)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A practical user guide for R in analysis and visualisation." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Basic modelling | R cookbook for the casual dabbler (2nd edition)" />
  
  <meta name="twitter:description" content="A practical user guide for R in analysis and visualisation." />
  

<meta name="author" content="Charles Coverdale" />


<meta name="date" content="2025-02-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="charts.html"/>
<link rel="next" href="hypothesis-testing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Cookbook for the Casual Dabbler</a></li> 

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#additional-resources"><i class="fa fa-check"></i><b>1.2</b> Additional resources</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#limitations"><i class="fa fa-check"></i><b>1.3</b> Limitations</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.4</b> About the author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html"><i class="fa fa-check"></i><b>2</b> Making maps beautiful</a>
<ul>
<li class="chapter" data-level="2.1" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#why-use-a-map"><i class="fa fa-check"></i><b>2.1</b> Why use a map</a></li>
<li class="chapter" data-level="2.2" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-okay-to-good"><i class="fa fa-check"></i><b>2.3</b> From okay to good</a></li>
<li class="chapter" data-level="2.4" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-good-to-great"><i class="fa fa-check"></i><b>2.4</b> From good to great</a></li>
<li class="chapter" data-level="2.5" data-path="making-maps-beautiful.html"><a href="making-maps-beautiful.html#from-great-to-fantastic"><i class="fa fa-check"></i><b>2.5</b> From great to fantastic</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>3</b> Charts</a>
<ul>
<li class="chapter" data-level="3.1" data-path="charts.html"><a href="charts.html#packages-matter"><i class="fa fa-check"></i><b>3.1</b> Packages matter</a></li>
<li class="chapter" data-level="3.2" data-path="charts.html"><a href="charts.html#make-the-data-tidy"><i class="fa fa-check"></i><b>3.2</b> Make the data tidy</a></li>
<li class="chapter" data-level="3.3" data-path="charts.html"><a href="charts.html#line-plot"><i class="fa fa-check"></i><b>3.3</b> Line plot</a></li>
<li class="chapter" data-level="3.4" data-path="charts.html"><a href="charts.html#scatter-and-trend-plot"><i class="fa fa-check"></i><b>3.4</b> Scatter and trend plot</a></li>
<li class="chapter" data-level="3.5" data-path="charts.html"><a href="charts.html#shading-areas-on-plots"><i class="fa fa-check"></i><b>3.5</b> Shading areas on plots</a></li>
<li class="chapter" data-level="3.6" data-path="charts.html"><a href="charts.html#bar-chart"><i class="fa fa-check"></i><b>3.6</b> Bar chart</a></li>
<li class="chapter" data-level="3.7" data-path="charts.html"><a href="charts.html#stacked-bar-chart"><i class="fa fa-check"></i><b>3.7</b> Stacked bar chart</a></li>
<li class="chapter" data-level="3.8" data-path="charts.html"><a href="charts.html#histogram"><i class="fa fa-check"></i><b>3.8</b> Histogram</a></li>
<li class="chapter" data-level="3.9" data-path="charts.html"><a href="charts.html#ridge-chart"><i class="fa fa-check"></i><b>3.9</b> Ridge chart</a></li>
<li class="chapter" data-level="3.10" data-path="charts.html"><a href="charts.html#bbc-style-bar-charts-categorical"><i class="fa fa-check"></i><b>3.10</b> BBC style: Bar charts (categorical)</a></li>
<li class="chapter" data-level="3.11" data-path="charts.html"><a href="charts.html#bbc-style-dumbbell-charts"><i class="fa fa-check"></i><b>3.11</b> BBC style: Dumbbell charts</a></li>
<li class="chapter" data-level="3.12" data-path="charts.html"><a href="charts.html#facet-wraps"><i class="fa fa-check"></i><b>3.12</b> Facet wraps</a></li>
<li class="chapter" data-level="3.13" data-path="charts.html"><a href="charts.html#pie-chart"><i class="fa fa-check"></i><b>3.13</b> Pie chart</a></li>
<li class="chapter" data-level="3.14" data-path="charts.html"><a href="charts.html#patchwork"><i class="fa fa-check"></i><b>3.14</b> Patchwork</a></li>
<li class="chapter" data-level="3.15" data-path="charts.html"><a href="charts.html#saving-to-powerpoint"><i class="fa fa-check"></i><b>3.15</b> Saving to powerpoint</a></li>
<li class="chapter" data-level="3.16" data-path="charts.html"><a href="charts.html#automating-chart-creation"><i class="fa fa-check"></i><b>3.16</b> Automating chart creation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-modelling.html"><a href="basic-modelling.html"><i class="fa fa-check"></i><b>4</b> Basic modelling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-modelling.html"><a href="basic-modelling.html#source-format-and-plot-data"><i class="fa fa-check"></i><b>4.1</b> Source, format, and plot data</a></li>
<li class="chapter" data-level="4.2" data-path="basic-modelling.html"><a href="basic-modelling.html#build-a-linear-model"><i class="fa fa-check"></i><b>4.2</b> Build a linear model</a></li>
<li class="chapter" data-level="4.3" data-path="basic-modelling.html"><a href="basic-modelling.html#analyse-the-model-fit"><i class="fa fa-check"></i><b>4.3</b> Analyse the model fit</a></li>
<li class="chapter" data-level="4.4" data-path="basic-modelling.html"><a href="basic-modelling.html#compare-the-predicted-values-with-the-actual-values"><i class="fa fa-check"></i><b>4.4</b> Compare the predicted values with the actual values</a></li>
<li class="chapter" data-level="4.5" data-path="basic-modelling.html"><a href="basic-modelling.html#analyse-the-residuals"><i class="fa fa-check"></i><b>4.5</b> Analyse the residuals</a></li>
<li class="chapter" data-level="4.6" data-path="basic-modelling.html"><a href="basic-modelling.html#linear-regression-with-more-than-one-variable"><i class="fa fa-check"></i><b>4.6</b> Linear regression with more than one variable</a></li>
<li class="chapter" data-level="4.7" data-path="basic-modelling.html"><a href="basic-modelling.html#fitting-a-polynomial-regression"><i class="fa fa-check"></i><b>4.7</b> Fitting a polynomial regression</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-quick-refresher"><i class="fa fa-check"></i><b>5.1</b> A quick refresher</a></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#t-testing-our-first-hypothesis"><i class="fa fa-check"></i><b>5.2</b> T-testing our first hypothesis</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#understanding-tailed-tests"><i class="fa fa-check"></i><b>5.3</b> Understanding tailed tests</a></li>
<li class="chapter" data-level="5.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#correlation"><i class="fa fa-check"></i><b>5.4</b> Correlation</a></li>
<li class="chapter" data-level="5.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-the-mean"><i class="fa fa-check"></i><b>5.5</b> Confidence intervals for the mean</a></li>
<li class="chapter" data-level="5.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-a-model"><i class="fa fa-check"></i><b>5.6</b> Confidence intervals for a model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>6</b> Forecasting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="forecasting.html"><a href="forecasting.html#arima-models"><i class="fa fa-check"></i><b>6.1</b> ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>7</b> Web scraping</a>
<ul>
<li class="chapter" data-level="7.1" data-path="web-scraping.html"><a href="web-scraping.html#why-it-matters"><i class="fa fa-check"></i><b>7.1</b> Why it matters</a></li>
<li class="chapter" data-level="7.2" data-path="web-scraping.html"><a href="web-scraping.html#anatomy-of-a-webpage"><i class="fa fa-check"></i><b>7.2</b> Anatomy of a webpage</a></li>
<li class="chapter" data-level="7.3" data-path="web-scraping.html"><a href="web-scraping.html#scraping-a-table"><i class="fa fa-check"></i><b>7.3</b> Scraping a table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>8</b> Text mining</a>
<ul>
<li class="chapter" data-level="8.1" data-path="text-mining.html"><a href="text-mining.html#frequency-analysis"><i class="fa fa-check"></i><b>8.1</b> Frequency analysis</a></li>
<li class="chapter" data-level="8.2" data-path="text-mining.html"><a href="text-mining.html#sentiment-analysis"><i class="fa fa-check"></i><b>8.2</b> Sentiment analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>9</b> Geocoding</a>
<ul>
<li class="chapter" data-level="9.1" data-path="geocoding.html"><a href="geocoding.html#lats-and-longs"><i class="fa fa-check"></i><b>9.1</b> Lats and longs</a></li>
<li class="chapter" data-level="9.2" data-path="geocoding.html"><a href="geocoding.html#spatial-data"><i class="fa fa-check"></i><b>9.2</b> Spatial data</a></li>
<li class="chapter" data-level="9.3" data-path="geocoding.html"><a href="geocoding.html#google-api"><i class="fa fa-check"></i><b>9.3</b> Google API</a></li>
<li class="chapter" data-level="9.4" data-path="geocoding.html"><a href="geocoding.html#geocode-analysis"><i class="fa fa-check"></i><b>9.4</b> Geocode analysis</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="drivetime-analysis.html"><a href="drivetime-analysis.html"><i class="fa fa-check"></i><b>10</b> Drivetime analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="drivetime-analysis.html"><a href="drivetime-analysis.html#method-1-osrm-isochrones"><i class="fa fa-check"></i><b>10.1</b> Method 1: OSRM isochrones</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="raster-data.html"><a href="raster-data.html"><i class="fa fa-check"></i><b>11</b> Raster data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="raster-data.html"><a href="raster-data.html#import-raster"><i class="fa fa-check"></i><b>11.1</b> Import raster</a></li>
<li class="chapter" data-level="11.2" data-path="raster-data.html"><a href="raster-data.html#choosing-geographies"><i class="fa fa-check"></i><b>11.2</b> Choosing geographies</a></li>
<li class="chapter" data-level="11.3" data-path="raster-data.html"><a href="raster-data.html#analysis-with-raster-data"><i class="fa fa-check"></i><b>11.3</b> Analysis with raster data</a></li>
<li class="chapter" data-level="11.4" data-path="raster-data.html"><a href="raster-data.html#making-an-interactive-map"><i class="fa fa-check"></i><b>11.4</b> Making an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="australian-economic-data.html"><a href="australian-economic-data.html"><i class="fa fa-check"></i><b>12</b> Australian economic data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="australian-economic-data.html"><a href="australian-economic-data.html#gdp"><i class="fa fa-check"></i><b>12.1</b> GDP</a></li>
<li class="chapter" data-level="12.2" data-path="australian-economic-data.html"><a href="australian-economic-data.html#unemployment-rate"><i class="fa fa-check"></i><b>12.2</b> Unemployment rate</a></li>
<li class="chapter" data-level="12.3" data-path="australian-economic-data.html"><a href="australian-economic-data.html#inflation-cpi"><i class="fa fa-check"></i><b>12.3</b> Inflation (CPI)</a></li>
<li class="chapter" data-level="12.4" data-path="australian-economic-data.html"><a href="australian-economic-data.html#wage-price-index"><i class="fa fa-check"></i><b>12.4</b> Wage Price Index</a></li>
<li class="chapter" data-level="12.5" data-path="australian-economic-data.html"><a href="australian-economic-data.html#aud-exchange-rate"><i class="fa fa-check"></i><b>12.5</b> AUD exchange rate</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="australian-election-data.html"><a href="australian-election-data.html"><i class="fa fa-check"></i><b>13</b> Australian election data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="australian-election-data.html"><a href="australian-election-data.html#election-maps"><i class="fa fa-check"></i><b>13.1</b> Election maps</a></li>
<li class="chapter" data-level="13.2" data-path="australian-election-data.html"><a href="australian-election-data.html#analysis"><i class="fa fa-check"></i><b>13.2</b> Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="australian-election-data.html"><a href="australian-election-data.html#trends"><i class="fa fa-check"></i><b>13.3</b> Trends</a></li>
<li class="chapter" data-level="13.4" data-path="australian-election-data.html"><a href="australian-election-data.html#booth-data"><i class="fa fa-check"></i><b>13.4</b> Booth data</a></li>
<li class="chapter" data-level="13.5" data-path="australian-election-data.html"><a href="australian-election-data.html#informal-votes"><i class="fa fa-check"></i><b>13.5</b> Informal votes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bayesian-for-the-common-man.html"><a href="bayesian-for-the-common-man.html"><i class="fa fa-check"></i><b>14</b> Bayesian for the common man</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bayesian-for-the-common-man.html"><a href="bayesian-for-the-common-man.html#enter-rev.-bayes"><i class="fa fa-check"></i><b>14.1</b> Enter Rev. Bayes</a>
<ul>
<li><a href="bayesian-for-the-common-man.html#pb-a-fracpa-b-pbpa" id="toc-pb-a-fracpa-b-pbpa"><span class="toc-section-number">14.1.1</span> <span class="math display">\[
P(B| A) = \frac{P(A | B) P(B)}{P(A)}
\]</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>15</b> Causal inference</a>
<ul>
<li class="chapter" data-level="15.1" data-path="causal-inference.html"><a href="causal-inference.html#what-causes-what"><i class="fa fa-check"></i><b>15.1</b> What causes what</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>16</b> Functions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="functions.html"><a href="functions.html#components"><i class="fa fa-check"></i><b>16.1</b> Components</a></li>
<li class="chapter" data-level="16.2" data-path="functions.html"><a href="functions.html#luhn-example"><i class="fa fa-check"></i><b>16.2</b> Luhn example</a></li>
<li class="chapter" data-level="16.3" data-path="functions.html"><a href="functions.html#loops-in-functions"><i class="fa fa-check"></i><b>16.3</b> Loops in functions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>17</b> Packages</a>
<ul>
<li class="chapter" data-level="17.1" data-path="packages.html"><a href="packages.html#pack-it-up"><i class="fa fa-check"></i><b>17.1</b> Pack it up</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.linkedin.com/in/charlescoverdale/" target="blank">Connect with me on linkedin</a></li>
<li><a href="https://github.com/charlescoverdale/casualdabbler2e" target="blank">Get the code on github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R cookbook for the casual dabbler (2nd edition)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-modelling" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Basic modelling<a href="basic-modelling.html#basic-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Creating a model is an essential part of forecasting and data analysis.</p>
<p>I’ve put together a quick guide on my process for modelling data and checking model fit.</p>
<p>The source data I use in this example is Melbourne’s weather record over a 12 month period. Daily temperature is based on macroscale weather and climate systems, however many observable measurements are correlated (i.e. hot days tend to have lots of sunshine). This makes using weather data great for model building.</p>
<div id="source-format-and-plot-data" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Source, format, and plot data<a href="basic-modelling.html#source-format-and-plot-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we get started, it is useful to have some packages up and running.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="basic-modelling.html#cb30-1" tabindex="-1"></a><span class="co">#Useful packages for regression</span></span>
<span id="cb30-2"><a href="basic-modelling.html#cb30-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb30-3"><a href="basic-modelling.html#cb30-3" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb30-4"><a href="basic-modelling.html#cb30-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-5"><a href="basic-modelling.html#cb30-5" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-6"><a href="basic-modelling.html#cb30-6" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb30-7"><a href="basic-modelling.html#cb30-7" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb30-8"><a href="basic-modelling.html#cb30-8" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<p>I’ve put together a csv file of weather observations in Melbourne in 2019. We begin our model by downloading the data from Github.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="basic-modelling.html#cb31-1" tabindex="-1"></a><span class="co">#Input data</span></span>
<span id="cb31-2"><a href="basic-modelling.html#cb31-2" tabindex="-1"></a>link <span class="ot">&lt;-</span> <span class="st">&quot;data/MEL_weather_2019.csv&quot;</span></span>
<span id="cb31-3"><a href="basic-modelling.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="basic-modelling.html#cb31-4" tabindex="-1"></a><span class="co"># We&#39;ll read this data in as a dataframe</span></span>
<span id="cb31-5"><a href="basic-modelling.html#cb31-5" tabindex="-1"></a><span class="co"># The &#39;check.names&#39; function set to false means the funny units that the BOM use for column names won&#39;t affect the import.</span></span>
<span id="cb31-6"><a href="basic-modelling.html#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="basic-modelling.html#cb31-7" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(link, <span class="at">check.names =</span> F)</span>
<span id="cb31-8"><a href="basic-modelling.html#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="basic-modelling.html#cb31-9" tabindex="-1"></a><span class="fu">head</span>(MEL_weather_2019)</span></code></pre></div>
<p>This data is relatively clean. One handy change to make is to make the date into a dynamic format (to easily switch between months, years, etc).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="basic-modelling.html#cb32-1" tabindex="-1"></a><span class="co">#Add a proper date column</span></span>
<span id="cb32-2"><a href="basic-modelling.html#cb32-2" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="basic-modelling.html#cb32-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">make_date</span>(Year, Month, Day))</span></code></pre></div>
<p>We also notice that some of the column names have symbols in them. This can be tricky to work with, so let’s rename some columns into something more manageable.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="basic-modelling.html#cb33-1" tabindex="-1"></a><span class="co">#Rename key df variables</span></span>
<span id="cb33-2"><a href="basic-modelling.html#cb33-2" tabindex="-1"></a><span class="fu">names</span>(MEL_weather_2019)[<span class="dv">4</span>]<span class="ot">&lt;-</span> <span class="st">&quot;Solar_exposure&quot;</span></span>
<span id="cb33-3"><a href="basic-modelling.html#cb33-3" tabindex="-1"></a><span class="fu">names</span>(MEL_weather_2019)[<span class="dv">5</span>]<span class="ot">&lt;-</span> <span class="st">&quot;Rainfall&quot;</span></span>
<span id="cb33-4"><a href="basic-modelling.html#cb33-4" tabindex="-1"></a><span class="fu">names</span>(MEL_weather_2019)[<span class="dv">6</span>]<span class="ot">&lt;-</span> <span class="st">&quot;Max_temp&quot;</span></span>
<span id="cb33-5"><a href="basic-modelling.html#cb33-5" tabindex="-1"></a>    </span>
<span id="cb33-6"><a href="basic-modelling.html#cb33-6" tabindex="-1"></a><span class="fu">head</span>(MEL_weather_2019)</span></code></pre></div>
<p>We’re aiming to investigate if other weather variables can predict maximum temperatures. Solar exposure seems like a plausible place to start. We start by plotting the two variables to if there is a trend.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="basic-modelling.html#cb34-1" tabindex="-1"></a><span class="co">#Plot the data</span></span>
<span id="cb34-2"><a href="basic-modelling.html#cb34-2" tabindex="-1"></a>MEL_temp_investigate <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(MEL_weather_2019)<span class="sc">+</span></span>
<span id="cb34-3"><a href="basic-modelling.html#cb34-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Max_temp, <span class="at">x=</span>Solar_exposure),<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-4"><a href="basic-modelling.html#cb34-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Does solar exposure drive temperature in Melbourne?&quot;</span>,</span>
<span id="cb34-5"><a href="basic-modelling.html#cb34-5" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meteorology 2020&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="basic-modelling.html#cb34-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Solar exposure&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-7"><a href="basic-modelling.html#cb34-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Maximum temperature °C&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-8"><a href="basic-modelling.html#cb34-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb34-9"><a href="basic-modelling.html#cb34-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb34-10"><a href="basic-modelling.html#cb34-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb34-11"><a href="basic-modelling.html#cb34-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb34-12"><a href="basic-modelling.html#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="basic-modelling.html#cb34-13" tabindex="-1"></a>MEL_temp_investigate</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Eyeballing the chart above, there seems to be a correlation between the two data sets. We’ll do one more quick plot to analyse the data. What is the distribution of temperature?</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="basic-modelling.html#cb35-1" tabindex="-1"></a><span class="fu">ggplot</span>(MEL_weather_2019, <span class="fu">aes</span>(<span class="at">x=</span>Max_temp)) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="basic-modelling.html#cb35-2" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-3"><a href="basic-modelling.html#cb35-3" tabindex="-1"></a> <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>,<span class="at">colour=</span><span class="st">&quot;darkblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-4"><a href="basic-modelling.html#cb35-4" tabindex="-1"></a>  </span>
<span id="cb35-5"><a href="basic-modelling.html#cb35-5" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="dv">40</span>,<span class="dv">45</span>),</span>
<span id="cb35-6"><a href="basic-modelling.html#cb35-6" tabindex="-1"></a>                    <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb35-7"><a href="basic-modelling.html#cb35-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Temperature&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-8"><a href="basic-modelling.html#cb35-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-9"><a href="basic-modelling.html#cb35-9" tabindex="-1"></a>  </span>
<span id="cb35-10"><a href="basic-modelling.html#cb35-10" tabindex="-1"></a> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-11"><a href="basic-modelling.html#cb35-11" tabindex="-1"></a> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb35-12"><a href="basic-modelling.html#cb35-12" tabindex="-1"></a> <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>We can see here the data is right skewed (i.e. the mean will be greater than the median). We’ll need to keep this in mind. Let’s start building a model.</p>
</div>
<div id="build-a-linear-model" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Build a linear model<a href="basic-modelling.html#build-a-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We start by looking whether a simple linear regression of solar exposure seems to be correlated with temperature. In R, we can use the linear model (lm) function.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="basic-modelling.html#cb36-1" tabindex="-1"></a><span class="co">#Create a straight line estimate to fit the data</span></span>
<span id="cb36-2"><a href="basic-modelling.html#cb36-2" tabindex="-1"></a>temp_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Max_temp<span class="sc">~</span>Solar_exposure, <span class="at">data=</span>MEL_weather_2019)</span></code></pre></div>
</div>
<div id="analyse-the-model-fit" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Analyse the model fit<a href="basic-modelling.html#analyse-the-model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s see how well solar exposure explains changes in temperature</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="basic-modelling.html#cb37-1" tabindex="-1"></a><span class="co">#Call a summary of the model</span></span>
<span id="cb37-2"><a href="basic-modelling.html#cb37-2" tabindex="-1"></a><span class="fu">summary</span>(temp_model)</span></code></pre></div>
<p>The adjusted R squared value (one measure of model fit) is 0.3596. Furthermore the coefficient of our solar_exposure variable is statistically significant.</p>
</div>
<div id="compare-the-predicted-values-with-the-actual-values" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Compare the predicted values with the actual values<a href="basic-modelling.html#compare-the-predicted-values-with-the-actual-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can use this lm function to predict values of temperature based on the level of solar exposure. We can then compare this to the actual temperature record, and see how well the model fits the data set.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="basic-modelling.html#cb38-1" tabindex="-1"></a><span class="co">#Use this lm model to predict the values</span></span>
<span id="cb38-2"><a href="basic-modelling.html#cb38-2" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="basic-modelling.html#cb38-3" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">predicted_temp=</span><span class="fu">predict</span>(temp_model,<span class="at">newdata=</span>MEL_weather_2019))</span>
<span id="cb38-4"><a href="basic-modelling.html#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="basic-modelling.html#cb38-5" tabindex="-1"></a><span class="co">#Calculate the prediction interval</span></span>
<span id="cb38-6"><a href="basic-modelling.html#cb38-6" tabindex="-1"></a>prediction_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(temp_model, </span>
<span id="cb38-7"><a href="basic-modelling.html#cb38-7" tabindex="-1"></a>                               <span class="at">newdata=</span>MEL_weather_2019, </span>
<span id="cb38-8"><a href="basic-modelling.html#cb38-8" tabindex="-1"></a>                               <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb38-9"><a href="basic-modelling.html#cb38-9" tabindex="-1"></a><span class="fu">summary</span>(prediction_interval)</span>
<span id="cb38-10"><a href="basic-modelling.html#cb38-10" tabindex="-1"></a></span>
<span id="cb38-11"><a href="basic-modelling.html#cb38-11" tabindex="-1"></a><span class="co">#Bind this prediction interval data back to the main set</span></span>
<span id="cb38-12"><a href="basic-modelling.html#cb38-12" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(MEL_weather_2019,prediction_interval)</span>
<span id="cb38-13"><a href="basic-modelling.html#cb38-13" tabindex="-1"></a>MEL_weather_2019</span></code></pre></div>
<p>Model fit is easier to interpret graphically. Let’s plot the data with the model overlaid.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="basic-modelling.html#cb39-1" tabindex="-1"></a><span class="co">#Plot a chart with data and model on it</span></span>
<span id="cb39-2"><a href="basic-modelling.html#cb39-2" tabindex="-1"></a>MEL_temp_predicted <span class="ot">&lt;-</span> </span>
<span id="cb39-3"><a href="basic-modelling.html#cb39-3" tabindex="-1"></a><span class="fu">ggplot</span>(MEL_weather_2019)<span class="sc">+</span></span>
<span id="cb39-4"><a href="basic-modelling.html#cb39-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Max_temp, <span class="at">x=</span>Solar_exposure),</span>
<span id="cb39-5"><a href="basic-modelling.html#cb39-5" tabindex="-1"></a>                 <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-6"><a href="basic-modelling.html#cb39-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted_temp,<span class="at">x=</span>Solar_exposure),</span>
<span id="cb39-7"><a href="basic-modelling.html#cb39-7" tabindex="-1"></a>                <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-8"><a href="basic-modelling.html#cb39-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y=</span>Max_temp, <span class="at">x=</span> Solar_exposure), </span>
<span id="cb39-9"><a href="basic-modelling.html#cb39-9" tabindex="-1"></a>              <span class="at">method=</span>lm)<span class="sc">+</span></span>
<span id="cb39-10"><a href="basic-modelling.html#cb39-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>lwr,<span class="at">x=</span>Solar_exposure),</span>
<span id="cb39-11"><a href="basic-modelling.html#cb39-11" tabindex="-1"></a>            <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-12"><a href="basic-modelling.html#cb39-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>upr,<span class="at">x=</span>Solar_exposure),</span>
<span id="cb39-13"><a href="basic-modelling.html#cb39-13" tabindex="-1"></a>            <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-14"><a href="basic-modelling.html#cb39-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> </span>
<span id="cb39-15"><a href="basic-modelling.html#cb39-15" tabindex="-1"></a>       <span class="st">&quot;Does solar exposure drive temperature in Melbourne?&quot;</span>,</span>
<span id="cb39-16"><a href="basic-modelling.html#cb39-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Investigation using linear regression&#39;</span>,</span>
<span id="cb39-17"><a href="basic-modelling.html#cb39-17" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meteorology 2020&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-18"><a href="basic-modelling.html#cb39-18" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Solar exposure&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-19"><a href="basic-modelling.html#cb39-19" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Maximum temperature °C&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-20"><a href="basic-modelling.html#cb39-20" tabindex="-1"></a>  </span>
<span id="cb39-21"><a href="basic-modelling.html#cb39-21" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb39-22"><a href="basic-modelling.html#cb39-22" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="dv">40</span>))<span class="sc">+</span></span>
<span id="cb39-23"><a href="basic-modelling.html#cb39-23" tabindex="-1"></a> </span>
<span id="cb39-24"><a href="basic-modelling.html#cb39-24" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb39-25"><a href="basic-modelling.html#cb39-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb39-26"><a href="basic-modelling.html#cb39-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb39-27"><a href="basic-modelling.html#cb39-27" tabindex="-1"></a></span>
<span id="cb39-28"><a href="basic-modelling.html#cb39-28" tabindex="-1"></a>MEL_temp_predicted</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>This chart includes the model (blue line), confidence interval (grey band around the blue line), and a prediction interval (red dotted line). A prediction interval reflects the uncertainty around a single value (put simple: what is the reasonable upper and lower bound that this data point could be estimated at?). A confidence interval reflects the uncertainty around the mean prediction values (put simply: what is a reasonable upper and lower bound for the blue line at this x value?). Therefore, a prediction interval will be generally much wider than a confidence interval for the same value.</p>
</div>
<div id="analyse-the-residuals" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Analyse the residuals<a href="basic-modelling.html#analyse-the-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="basic-modelling.html#cb40-1" tabindex="-1"></a><span class="co">#Add the residuals to the series</span></span>
<span id="cb40-2"><a href="basic-modelling.html#cb40-2" tabindex="-1"></a>residuals_temp_predict <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="basic-modelling.html#cb40-3" tabindex="-1"></a>  <span class="fu">add_residuals</span>(temp_model)</span></code></pre></div>
<p>Plot these residuals in a chart.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="basic-modelling.html#cb41-1" tabindex="-1"></a>residuals_temp_predict_chart <span class="ot">&lt;-</span> </span>
<span id="cb41-2"><a href="basic-modelling.html#cb41-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>residuals_temp_predict,</span>
<span id="cb41-3"><a href="basic-modelling.html#cb41-3" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x=</span>Solar_exposure, <span class="at">y=</span>resid), <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-4"><a href="basic-modelling.html#cb41-4" tabindex="-1"></a>         </span>
<span id="cb41-5"><a href="basic-modelling.html#cb41-5" tabindex="-1"></a>         <span class="fu">geom_ref_line</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb41-6"><a href="basic-modelling.html#cb41-6" tabindex="-1"></a>         <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-7"><a href="basic-modelling.html#cb41-7" tabindex="-1"></a>  </span>
<span id="cb41-8"><a href="basic-modelling.html#cb41-8" tabindex="-1"></a>         <span class="fu">xlab</span>(<span class="st">&quot;Solar exposure&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-9"><a href="basic-modelling.html#cb41-9" tabindex="-1"></a>         <span class="fu">ylab</span>(<span class="st">&quot;Maximum temperature (°C)&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-10"><a href="basic-modelling.html#cb41-10" tabindex="-1"></a>         <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-11"><a href="basic-modelling.html#cb41-11" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residual values from the linear model&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-12"><a href="basic-modelling.html#cb41-12" tabindex="-1"></a>  </span>
<span id="cb41-13"><a href="basic-modelling.html#cb41-13" tabindex="-1"></a>         <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb41-14"><a href="basic-modelling.html#cb41-14" tabindex="-1"></a>  </span>
<span id="cb41-15"><a href="basic-modelling.html#cb41-15" tabindex="-1"></a>         <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb41-16"><a href="basic-modelling.html#cb41-16" tabindex="-1"></a>residuals_temp_predict_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="linear-regression-with-more-than-one-variable" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Linear regression with more than one variable<a href="basic-modelling.html#linear-regression-with-more-than-one-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The linear model above is *okay*, but can we make it better? Let’s start by adding in some more variables into the linear regression.</p>
<p>Rainfall data might assist our model in predicting temperature. Let’s add in that variable and analyse the results.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="basic-modelling.html#cb42-1" tabindex="-1"></a>temp_model_2 <span class="ot">&lt;-</span> </span>
<span id="cb42-2"><a href="basic-modelling.html#cb42-2" tabindex="-1"></a><span class="fu">lm</span>(Max_temp <span class="sc">~</span> Solar_exposure <span class="sc">+</span> Rainfall, <span class="at">data=</span>MEL_weather_2019)</span>
<span id="cb42-3"><a href="basic-modelling.html#cb42-3" tabindex="-1"></a><span class="fu">summary</span>(temp_model_2)</span></code></pre></div>
<p>We can see that adding in rainfall made the model better (R squared value has increased to 0.4338).</p>
<p>Next, we consider whether solar exposure and rainfall might be related to each other, as well as to temperature. For our third temperature model, we add an interaction variable between solar exposure and rainfall.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="basic-modelling.html#cb43-1" tabindex="-1"></a>temp_model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Max_temp <span class="sc">~</span> Solar_exposure <span class="sc">+</span> </span>
<span id="cb43-2"><a href="basic-modelling.html#cb43-2" tabindex="-1"></a>                              Rainfall <span class="sc">+</span> </span>
<span id="cb43-3"><a href="basic-modelling.html#cb43-3" tabindex="-1"></a>                              Solar_exposure<span class="sc">:</span>Rainfall, </span>
<span id="cb43-4"><a href="basic-modelling.html#cb43-4" tabindex="-1"></a>                              <span class="at">data=</span>MEL_weather_2019)</span>
<span id="cb43-5"><a href="basic-modelling.html#cb43-5" tabindex="-1"></a><span class="fu">summary</span>(temp_model_3)</span></code></pre></div>
<p>We now see this variable is significant, and improves the model slightly (seen by an adjusted R squared of 0.4529).</p>
</div>
<div id="fitting-a-polynomial-regression" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Fitting a polynomial regression<a href="basic-modelling.html#fitting-a-polynomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When analysing the above data set, we see the issue is the sheer variance of temperatures associated with every other variable (it turns out weather forecasting is notoriously difficult).</p>
<p>However we can expect that temperature follows a non-linear pattern throughout the year (in Australia it is hot in January-March, cold in June-August, then starts to warm up again). A linear model (e.g. a straight line) will be a very bad model for temperature — we need to introduce polynomials.</p>
<p>For simplicity, we will introduce a new variable (Day_number) which is the day of the year (e.g. 1 January is #1, 31 December is #366).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="basic-modelling.html#cb44-1" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="basic-modelling.html#cb44-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day_number=</span><span class="fu">row_number</span>())</span>
<span id="cb44-3"><a href="basic-modelling.html#cb44-3" tabindex="-1"></a><span class="fu">head</span>(MEL_weather_2019)</span></code></pre></div>
<p>Using the same dataset as above, let’s plot temperature in Melbourne in 2019.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="basic-modelling.html#cb45-1" tabindex="-1"></a>MEL_temp_chart <span class="ot">&lt;-</span> </span>
<span id="cb45-2"><a href="basic-modelling.html#cb45-2" tabindex="-1"></a><span class="fu">ggplot</span>(MEL_weather_2019)<span class="sc">+</span></span>
<span id="cb45-3"><a href="basic-modelling.html#cb45-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day_number, <span class="at">y =</span> Max_temp)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="basic-modelling.html#cb45-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Melbourne temperature profile&#39;</span>,</span>
<span id="cb45-5"><a href="basic-modelling.html#cb45-5" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">&#39;Daily maximum temperature recorded in Melbourne in 2019&#39;</span>,</span>
<span id="cb45-6"><a href="basic-modelling.html#cb45-6" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meteorology 2020&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="basic-modelling.html#cb45-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Day of the year&quot;</span>)<span class="sc">+</span></span>
<span id="cb45-8"><a href="basic-modelling.html#cb45-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Temperature&quot;</span>)<span class="sc">+</span></span>
<span id="cb45-9"><a href="basic-modelling.html#cb45-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()                    </span>
<span id="cb45-10"><a href="basic-modelling.html#cb45-10" tabindex="-1"></a>                </span>
<span id="cb45-11"><a href="basic-modelling.html#cb45-11" tabindex="-1"></a>MEL_temp_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>We can see we’ll need a non-linear model to fit this data.</p>
<p>Below we create a few different models. We start with a normal straight line model, then add an x² and x³ model. We then use these models and the ‘predict’ function to see what temperatures they forecast based on the input data.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="basic-modelling.html#cb46-1" tabindex="-1"></a><span class="co">#Create a straight line estimate to fit the data</span></span>
<span id="cb46-2"><a href="basic-modelling.html#cb46-2" tabindex="-1"></a>poly1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Max_temp <span class="sc">~</span> <span class="fu">poly</span>(Day_number,<span class="dv">1</span>,<span class="at">raw=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-3"><a href="basic-modelling.html#cb46-3" tabindex="-1"></a>         <span class="at">data=</span>MEL_weather_2019)</span>
<span id="cb46-4"><a href="basic-modelling.html#cb46-4" tabindex="-1"></a><span class="fu">summary</span>(poly1)</span>
<span id="cb46-5"><a href="basic-modelling.html#cb46-5" tabindex="-1"></a><span class="co">#Create a polynominal of order 2 to fit this data</span></span>
<span id="cb46-6"><a href="basic-modelling.html#cb46-6" tabindex="-1"></a>poly2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Max_temp <span class="sc">~</span> <span class="fu">poly</span>(Day_number,<span class="dv">2</span>,<span class="at">raw=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-7"><a href="basic-modelling.html#cb46-7" tabindex="-1"></a>         <span class="at">data=</span>MEL_weather_2019)</span>
<span id="cb46-8"><a href="basic-modelling.html#cb46-8" tabindex="-1"></a><span class="fu">summary</span>(poly2)</span>
<span id="cb46-9"><a href="basic-modelling.html#cb46-9" tabindex="-1"></a><span class="co">#Create a polynominal of order 3 to fit this data</span></span>
<span id="cb46-10"><a href="basic-modelling.html#cb46-10" tabindex="-1"></a>poly3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Max_temp <span class="sc">~</span> <span class="fu">poly</span>(Day_number,<span class="dv">3</span>,<span class="at">raw=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-11"><a href="basic-modelling.html#cb46-11" tabindex="-1"></a>         <span class="at">data=</span>MEL_weather_2019)</span>
<span id="cb46-12"><a href="basic-modelling.html#cb46-12" tabindex="-1"></a><span class="fu">summary</span>(poly3)</span>
<span id="cb46-13"><a href="basic-modelling.html#cb46-13" tabindex="-1"></a></span>
<span id="cb46-14"><a href="basic-modelling.html#cb46-14" tabindex="-1"></a><span class="co">#Use these models to predict</span></span>
<span id="cb46-15"><a href="basic-modelling.html#cb46-15" tabindex="-1"></a>MEL_weather_2019 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="basic-modelling.html#cb46-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poly1values=</span><span class="fu">predict</span>(poly1,<span class="at">newdata=</span>MEL_weather_2019))<span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="basic-modelling.html#cb46-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poly2values=</span><span class="fu">predict</span>(poly2,<span class="at">newdata=</span>MEL_weather_2019))<span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="basic-modelling.html#cb46-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poly3values=</span><span class="fu">predict</span>(poly3,<span class="at">newdata=</span>MEL_weather_2019))</span>
<span id="cb46-19"><a href="basic-modelling.html#cb46-19" tabindex="-1"></a></span>
<span id="cb46-20"><a href="basic-modelling.html#cb46-20" tabindex="-1"></a><span class="fu">head</span>(MEL_weather_2019)</span></code></pre></div>
<p>In the table above we can see the estimates for that data point from the various models.</p>
<p>To see how well the models did graphically, we can plot the original data series with the polynominal models overlaid.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="basic-modelling.html#cb47-1" tabindex="-1"></a><span class="co">#Plot a chart with all models on it</span></span>
<span id="cb47-2"><a href="basic-modelling.html#cb47-2" tabindex="-1"></a>MEL_weather_model_chart <span class="ot">&lt;-</span> </span>
<span id="cb47-3"><a href="basic-modelling.html#cb47-3" tabindex="-1"></a><span class="fu">ggplot</span>(MEL_weather_2019)<span class="sc">+</span></span>
<span id="cb47-4"><a href="basic-modelling.html#cb47-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span> Max_temp),<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-5"><a href="basic-modelling.html#cb47-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span> poly1values),<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="basic-modelling.html#cb47-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span> poly2values),<span class="at">col=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-7"><a href="basic-modelling.html#cb47-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span> poly3values),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-8"><a href="basic-modelling.html#cb47-8" tabindex="-1"></a>  </span>
<span id="cb47-9"><a href="basic-modelling.html#cb47-9" tabindex="-1"></a>  <span class="co">#Add text annotations</span></span>
<span id="cb47-10"><a href="basic-modelling.html#cb47-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x=</span><span class="dv">10</span>,<span class="at">y=</span><span class="dv">18</span>,<span class="at">label=</span><span class="st">&quot;data series&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">hjust=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb47-11"><a href="basic-modelling.html#cb47-11" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x=</span><span class="dv">10</span>,<span class="at">y=</span><span class="dv">16</span>,<span class="at">label=</span><span class="st">&quot;linear&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">hjust=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb47-12"><a href="basic-modelling.html#cb47-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x=</span><span class="dv">10</span>,<span class="at">y=</span><span class="dv">13</span>,<span class="at">label=</span><span class="fu">parse</span>(<span class="at">text=</span><span class="st">&quot;x^2&quot;</span>),<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">hjust=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb47-13"><a href="basic-modelling.html#cb47-13" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x=</span><span class="dv">10</span>,<span class="at">y=</span><span class="dv">10</span>,<span class="at">label=</span><span class="fu">parse</span>(<span class="at">text=</span><span class="st">&quot;x^3&quot;</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">hjust=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb47-14"><a href="basic-modelling.html#cb47-14" tabindex="-1"></a>  </span>
<span id="cb47-15"><a href="basic-modelling.html#cb47-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Estimating Melbourne&#39;s temperature&quot;</span>,</span>
<span id="cb47-16"><a href="basic-modelling.html#cb47-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Daily maximum temperature recorded in Melbourne in 2019&#39;</span>,</span>
<span id="cb47-17"><a href="basic-modelling.html#cb47-17" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Bureau of Meteorology 2020&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-18"><a href="basic-modelling.html#cb47-18" tabindex="-1"></a>  </span>
<span id="cb47-19"><a href="basic-modelling.html#cb47-19" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">366</span>)<span class="sc">+</span></span>
<span id="cb47-20"><a href="basic-modelling.html#cb47-20" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">10</span>,<span class="dv">45</span>)<span class="sc">+</span></span>
<span id="cb47-21"><a href="basic-modelling.html#cb47-21" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span></span>
<span id="cb47-22"><a href="basic-modelling.html#cb47-22" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">45</span>,<span class="dv">75</span>,<span class="dv">105</span>,<span class="dv">135</span>,<span class="dv">165</span>,<span class="dv">195</span>,<span class="dv">225</span>,<span class="dv">255</span>,<span class="dv">285</span>,<span class="dv">315</span>,<span class="dv">345</span>),</span>
<span id="cb47-23"><a href="basic-modelling.html#cb47-23" tabindex="-1"></a>  <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>),</span>
<span id="cb47-24"><a href="basic-modelling.html#cb47-24" tabindex="-1"></a>  <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb47-25"><a href="basic-modelling.html#cb47-25" tabindex="-1"></a>  <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">366</span>)) <span class="sc">+</span></span>
<span id="cb47-26"><a href="basic-modelling.html#cb47-26" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="dv">40</span>,<span class="dv">45</span>)) <span class="sc">+</span></span>
<span id="cb47-27"><a href="basic-modelling.html#cb47-27" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-28"><a href="basic-modelling.html#cb47-28" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;°C&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-29"><a href="basic-modelling.html#cb47-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb47-30"><a href="basic-modelling.html#cb47-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb47-31"><a href="basic-modelling.html#cb47-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb47-32"><a href="basic-modelling.html#cb47-32" tabindex="-1"></a></span>
<span id="cb47-33"><a href="basic-modelling.html#cb47-33" tabindex="-1"></a>MEL_weather_model_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>We can see in the chart above the polynomial models do much better at fitting the data. However, they are still highly variant.</p>
<p>Just how variant are they? We can look at the residuals to find out. The residuals is the gap between the observed data point (i.e. the grey line) and our model.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="basic-modelling.html#cb48-1" tabindex="-1"></a><span class="co">#Get the residuals for poly1</span></span>
<span id="cb48-2"><a href="basic-modelling.html#cb48-2" tabindex="-1"></a>residuals_poly1 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="basic-modelling.html#cb48-3" tabindex="-1"></a>  <span class="fu">add_residuals</span>(poly1)</span>
<span id="cb48-4"><a href="basic-modelling.html#cb48-4" tabindex="-1"></a>residuals_poly1_chart <span class="ot">&lt;-</span> </span>
<span id="cb48-5"><a href="basic-modelling.html#cb48-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>residuals_poly1,<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span>resid))<span class="sc">+</span></span>
<span id="cb48-6"><a href="basic-modelling.html#cb48-6" tabindex="-1"></a>  <span class="fu">geom_ref_line</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb48-7"><a href="basic-modelling.html#cb48-7" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb48-8"><a href="basic-modelling.html#cb48-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-9"><a href="basic-modelling.html#cb48-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;°C&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-10"><a href="basic-modelling.html#cb48-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb48-11"><a href="basic-modelling.html#cb48-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb48-12"><a href="basic-modelling.html#cb48-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb48-13"><a href="basic-modelling.html#cb48-13" tabindex="-1"></a>  <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb48-14"><a href="basic-modelling.html#cb48-14" tabindex="-1"></a>residuals_poly1_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="basic-modelling.html#cb49-1" tabindex="-1"></a><span class="co">#Get the residuals for poly2</span></span>
<span id="cb49-2"><a href="basic-modelling.html#cb49-2" tabindex="-1"></a>residuals_poly2 <span class="ot">&lt;-</span> MEL_weather_2019<span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="basic-modelling.html#cb49-3" tabindex="-1"></a>  <span class="fu">add_residuals</span>(poly2)</span>
<span id="cb49-4"><a href="basic-modelling.html#cb49-4" tabindex="-1"></a>residuals_poly2_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>residuals_poly2,<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span>resid))<span class="sc">+</span></span>
<span id="cb49-5"><a href="basic-modelling.html#cb49-5" tabindex="-1"></a>  <span class="fu">geom_ref_line</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">colour=</span><span class="st">&quot;green&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb49-6"><a href="basic-modelling.html#cb49-6" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb49-7"><a href="basic-modelling.html#cb49-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-8"><a href="basic-modelling.html#cb49-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;°C&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-9"><a href="basic-modelling.html#cb49-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb49-10"><a href="basic-modelling.html#cb49-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb49-11"><a href="basic-modelling.html#cb49-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb49-12"><a href="basic-modelling.html#cb49-12" tabindex="-1"></a>  <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb49-13"><a href="basic-modelling.html#cb49-13" tabindex="-1"></a>  </span>
<span id="cb49-14"><a href="basic-modelling.html#cb49-14" tabindex="-1"></a>residuals_poly2_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="basic-modelling.html#cb50-1" tabindex="-1"></a><span class="co">#Get the residuals for poly3</span></span>
<span id="cb50-2"><a href="basic-modelling.html#cb50-2" tabindex="-1"></a>residuals_poly3 <span class="ot">&lt;-</span> MEL_weather_2019 <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="basic-modelling.html#cb50-3" tabindex="-1"></a>  <span class="fu">add_residuals</span>(poly3)</span>
<span id="cb50-4"><a href="basic-modelling.html#cb50-4" tabindex="-1"></a>residuals_poly3_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>residuals_poly3,<span class="fu">aes</span>(<span class="at">x=</span>Day_number, <span class="at">y=</span>resid))<span class="sc">+</span></span>
<span id="cb50-5"><a href="basic-modelling.html#cb50-5" tabindex="-1"></a>  <span class="fu">geom_ref_line</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-6"><a href="basic-modelling.html#cb50-6" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb50-7"><a href="basic-modelling.html#cb50-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb50-8"><a href="basic-modelling.html#cb50-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb50-9"><a href="basic-modelling.html#cb50-9" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span></span>
<span id="cb50-10"><a href="basic-modelling.html#cb50-10" tabindex="-1"></a> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">45</span>,<span class="dv">75</span>,<span class="dv">105</span>,<span class="dv">135</span>,<span class="dv">165</span>,<span class="dv">195</span>,<span class="dv">225</span>,<span class="dv">255</span>,<span class="dv">285</span>,<span class="dv">315</span>,<span class="dv">345</span>),</span>
<span id="cb50-11"><a href="basic-modelling.html#cb50-11" tabindex="-1"></a> <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>),</span>
<span id="cb50-12"><a href="basic-modelling.html#cb50-12" tabindex="-1"></a> <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb50-13"><a href="basic-modelling.html#cb50-13" tabindex="-1"></a> <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">366</span>))<span class="sc">+</span></span>
<span id="cb50-14"><a href="basic-modelling.html#cb50-14" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-15"><a href="basic-modelling.html#cb50-15" tabindex="-1"></a> <span class="fu">ylab</span>(<span class="st">&quot;°C&quot;</span>)</span>
<span id="cb50-16"><a href="basic-modelling.html#cb50-16" tabindex="-1"></a>  </span>
<span id="cb50-17"><a href="basic-modelling.html#cb50-17" tabindex="-1"></a>residuals_poly3_chart</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-3.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="basic-modelling.html#cb51-1" tabindex="-1"></a>three_charts_single_page <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(</span>
<span id="cb51-2"><a href="basic-modelling.html#cb51-2" tabindex="-1"></a>  residuals_poly1_chart, </span>
<span id="cb51-3"><a href="basic-modelling.html#cb51-3" tabindex="-1"></a>  residuals_poly2_chart, </span>
<span id="cb51-4"><a href="basic-modelling.html#cb51-4" tabindex="-1"></a>  residuals_poly3_chart,</span>
<span id="cb51-5"><a href="basic-modelling.html#cb51-5" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">label_size=</span><span class="dv">16</span>)</span>
<span id="cb51-6"><a href="basic-modelling.html#cb51-6" tabindex="-1"></a>three_charts_single_page</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-4.png" width="672" /></p>
<p>As we move from a linear, to a x², to a x³ model, we see the residuals decrease in volatility.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="charts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hypothesis-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/charlescoverdale/casualdabbler2e/edit/master/04-basic-modelling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
